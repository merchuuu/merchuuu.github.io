<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>San Valent√≠n</title>

  <style>
    :root{
      --bg1:#07060f;
      --bg2:#1b0f2a;

      --paper:#fff7fb;
      --paper2:#fff0f8;
      --ink:#1d0c1d;
      --muted:#5b3f56;
      --line:rgba(29,12,29,.12);

      --pink:#ff4d8d;
      --pink2:#ff7ab6;
      --purple:#7c4dff;

      --shadow:0 18px 70px rgba(0,0,0,.40);
      --radius:22px;
      --radius2:30px;

      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--font);
      color:rgba(255,255,255,.92);
      background:
        radial-gradient(900px 700px at 18% 10%, rgba(255,77,141,.22), transparent 60%),
        radial-gradient(900px 700px at 85% 25%, rgba(124,77,255,.16), transparent 60%),
        radial-gradient(700px 500px at 50% 95%, rgba(255,122,182,.14), transparent 60%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }

    .wrap{max-width:980px;margin:0 auto;padding:20px 14px 40px}
    .top{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      margin-bottom:14px;
    }
    .pill{
      display:inline-flex;gap:8px;align-items:center;
      padding:8px 12px;border-radius:999px;
      border:1px solid rgba(255,255,255,.16);
      background:rgba(255,255,255,.07);
      backdrop-filter: blur(10px);
      color:rgba(255,255,255,.82);
      font-size:13px;
      max-width:100%;
      overflow:hidden;text-overflow:ellipsis;white-space:nowrap;
    }
    .miniBtns{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end}
    button{
      border:1px solid rgba(255,255,255,.18);
      background:rgba(255,255,255,.08);
      color:rgba(255,255,255,.92);
      padding:10px 12px;
      border-radius:14px;
      cursor:pointer;
      font-weight:800;
      letter-spacing:.2px;
      transition:transform .08s ease, filter .12s ease;
      backdrop-filter: blur(10px);
    }
    button:active{transform:translateY(1px)}
    button:hover{filter:brightness(1.05)}
    .primary{
      background:linear-gradient(180deg, rgba(255,77,141,.25), rgba(255,77,141,.12));
    }

    .book{
      border-radius:var(--radius2);
      box-shadow:var(--shadow);
      position:relative;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.15);
      backdrop-filter: blur(10px);
    }
    .bookTopGlow{
      position:absolute; inset:-2px;
      background:
        radial-gradient(520px 240px at 12% 18%, rgba(255,77,141,.22), transparent 64%),
        radial-gradient(520px 240px at 88% 10%, rgba(124,77,255,.16), transparent 64%),
        radial-gradient(420px 240px at 55% 85%, rgba(255,122,182,.14), transparent 64%);
      pointer-events:none;
    }

    .page{
      position:relative;
      background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      padding:16px;
      min-height: 72vh;
    }

    .paper{
      background:linear-gradient(180deg, var(--paper), var(--paper2));
      color:var(--ink);
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:18px;
      box-shadow: 0 12px 35px rgba(0,0,0,.20);
      position:relative;
      overflow:hidden;
    }
    .paper:after{
      content:"";
      position:absolute;
      right:-60px; bottom:-60px;
      width:140px; height:140px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.9), rgba(255,255,255,0) 60%);
      transform: rotate(10deg);
      opacity:.45;
      pointer-events:none;
    }

    .title{
      margin:0 0 8px;
      font-size:22px;
      letter-spacing:-.3px;
      line-height:1.2;
    }
    .subtitle{
      margin:0 0 14px;
      color:var(--muted);
      line-height:1.55;
      font-size:14px;
    }
    .divider{
      height:1px;
      background:rgba(29,12,29,.12);
      margin:14px 0;
    }

    .twoCols{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
      margin-top:12px;
    }
    @media (max-width:860px){
      .twoCols{grid-template-columns:1fr}
      .page{min-height: 78vh}
      .paper{padding:16px}
      .title{font-size:21px}
    }

    .frame{
      border-radius:18px;
      border:1px solid rgba(29,12,29,.14);
      overflow:hidden;
      background:#eee;
    }
    .img{
      display:block;
      width:100%;
      height:220px;
      object-fit:cover;
    }
    @media (max-width:480px){
      .img{height:210px}
    }

    .tag{
      display:inline-flex;align-items:center;gap:8px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(29,12,29,.14);
      background:rgba(255,255,255,.7);
      color:rgba(29,12,29,.78);
      font-size:12px;
      font-weight:800;
    }

    .valentineNote{
      margin-top:12px;
      padding:12px 12px;
      border-radius:16px;
      border:1px dashed rgba(255,77,141,.35);
      background: rgba(255,77,141,.07);
      color:rgba(29,12,29,.75);
      font-size:13px;
      line-height:1.55;
    }

    .nav{
      display:flex;
      gap:10px;
      justify-content:space-between;
      align-items:center;
      margin-top:12px;
    }
    .nav button{flex:1;min-width:0}

    .progress{
      display:flex;
      gap:8px;
      justify-content:center;
      align-items:center;
      margin-top:12px;
      padding-bottom:2px;
    }
    .dot{
      width:10px;height:10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.10);
    }
    .dot.on{
      background: rgba(255,77,141,.75);
      border-color: rgba(255,77,141,.75);
      box-shadow: 0 0 0 6px rgba(255,77,141,.12);
    }
    .swipeHint{
      margin-top:10px;
      display:flex;
      justify-content:center;
      color:rgba(255,255,255,.78);
      font-size:12px;
      gap:8px;
      user-select:none;
    }

    .map{
      position:relative;
      width:100%;
      padding-top:62%;
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(29,12,29,.14);
      background:#eee;
    }
    .map iframe{
      position:absolute; inset:0;
      width:100%; height:100%;
      border:0;
    }
    .link{
      display:inline-flex;gap:8px;align-items:center;
      padding:9px 10px;border-radius:14px;
      border:1px solid rgba(29,12,29,.14);
      background:rgba(255,255,255,.76);
      color:rgba(29,12,29,.84);
      text-decoration:none;
      font-weight:900;
      font-size:13px;
    }

    .pass{
      border:1px solid rgba(29,12,29,.14);
      border-radius:18px;
      background: rgba(255,255,255,.75);
      color: rgba(29,12,29,.88);
      padding:12px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    }
    .passTop{display:flex;justify-content:space-between;gap:10px;align-items:center;margin-bottom:10px}
    .passTop strong{font-size:13px;letter-spacing:.5px}
    .passGrid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
    @media (max-width:860px){ .passGrid{grid-template-columns:1fr} }
    .kv{border:1px solid rgba(29,12,29,.12);border-radius:14px;background:rgba(255,255,255,.7);padding:10px}
    .kv span{display:block;color:rgba(29,12,29,.55);font-size:12px}
    .kv b{display:block;margin-top:3px;font-size:14px}

    .pageFlip{
      animation: flip .35s ease;
      transform-origin:left center;
    }
    @keyframes flip{
      from{transform: perspective(900px) rotateY(-10deg); opacity:.6}
      to{transform: perspective(900px) rotateY(0deg); opacity:1}
    }

    .safePad{padding-bottom: env(safe-area-inset-bottom, 0px);}
  </style>
</head>

<body>
  <div class="wrap safePad">
    <div class="top">
      <div class="pill">üíò San Valent√≠n</div>
      <div class="miniBtns">
        <button class="primary" id="btnStart">Empezar</button>
        <button id="btnReset">Reiniciar</button>
      </div>
    </div>

    <section class="book" id="book" aria-label="Libro de pistas">
      <div class="bookTopGlow" aria-hidden="true"></div>
      <div class="page" id="page"></div>
    </section>

    <div class="progress" aria-label="Progreso">
      <div class="dot on" id="dot0"></div>
      <div class="dot" id="dot1"></div>
      <div class="dot" id="dot2"></div>
      <div class="dot" id="dot3"></div>
    </div>

    <div class="swipeHint">üëà Desliz√° para pasar p√°gina ‚Ä¢ üëâ</div>
  </div>

  <script>
    const PERSIST_PROGRESS = true;

    // Paso 1: Rafting carousel
    const RAFTING_IMAGES = [
      "https://backstrapi.latitur.com/uploads/copy_old_1755567853887_e99a61fa_7fe4_41ca_8df9_c82529e0a7b5_e18a004e72.webp",
      "https://www.argentinacabanas.com/sanrafael/fotos/raftingrioatuel/12.jpg",
      "https://www.saintjosephweb.com.ar/pics/actividad/large/8068485.jpg"
    ];

    // Paso 1: Relax carousel (Cacheuta)
    const RELAX_IMAGES = [
      "https://kahuak.com.ar/wp-content/uploads/2024/08/Mendoza_Set_2018_04_-60.webp",
      "https://www.tangol.com/Fotos/Tours/termas-de-cacheuta_874_202406281649021.Mobile.JPG",
      "https://dynamic-media-cdn.tripadvisor.com/media/photo-o/16/69/7c/f9/termas-cacheuta-full.jpg?w=1200&h=-1&s=1"
    ];

    // Paso 2: Hospedaje foto
    const HOTEL_IMAGE =
      "https://q-xx.bstatic.com/xdata/images/hotel/840x460/29585540.jpg?k=c9d280161bd3b5ed8d30a06a7fc260afc3202a2e8a4874edcfcd371a28355f98&o=";

    const INTERVAL_MS = 3200;

    const els = {
      page: document.getElementById("page"),
      btnStart: document.getElementById("btnStart"),
      btnReset: document.getElementById("btnReset"),
      book: document.getElementById("book"),
      dots: [
        document.getElementById("dot0"),
        document.getElementById("dot1"),
        document.getElementById("dot2"),
        document.getElementById("dot3"),
      ],
    };

    function setState(key, value){
      if (!PERSIST_PROGRESS) return;
      localStorage.setItem(key, String(value));
    }
    function getState(key, fallback){
      if (!PERSIST_PROGRESS) return fallback;
      const v = localStorage.getItem(key);
      return (v === null) ? fallback : Number(v);
    }

    // 0 = carta, 1 = paso1, 2 = paso2, 3 = paso3
    let currentPage = getState("sv_page", 0);
    let unlockedPage = getState("sv_unlocked", 0);

    let timers = [];
    function clearTimers(){
      timers.forEach(t => clearInterval(t));
      timers = [];
    }

    function startCarousel(imgId, images){
      const imgEl = document.getElementById(imgId);
      if (!imgEl) return;
      let i = 0;
      images.forEach(u => { const im = new Image(); im.src = u; });
      const t = setInterval(()=>{
        i = (i + 1) % images.length;
        imgEl.src = images[i];
      }, INTERVAL_MS);
      timers.push(t);
    }

    function setDots(pageIndex){
      els.dots.forEach((d, i)=> d.classList.toggle("on", i === pageIndex));
    }

    function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

    function unlockUpTo(pageIndex){
      unlockedPage = Math.max(unlockedPage, pageIndex);
      setState("sv_unlocked", unlockedPage);
    }

    function goTo(pageIndex, opts={animate:true}){
      clearTimers();
      pageIndex = clamp(pageIndex, 0, 3);

      if (pageIndex > unlockedPage) pageIndex = unlockedPage;

      currentPage = pageIndex;
      setState("sv_page", currentPage);

      render(pageIndex, opts.animate);
      setDots(pageIndex);
    }

    function next(){
      const target = clamp(currentPage + 1, 0, 3);
      unlockUpTo(target);
      goTo(target);
    }
    function prev(){
      goTo(clamp(currentPage - 1, 0, 3));
    }

    function render(pageIndex, animate=true){
      const flipClass = animate ? "pageFlip" : "";
      const commonNav = (leftText="Atr√°s", rightText="Siguiente", canLeft=true, canRight=true) => `
        <div class="nav">
          <button id="btnPrev" ${canLeft ? "" : "disabled"}>${leftText}</button>
          <button class="primary" id="btnNext" ${canRight ? "" : "disabled"}>${rightText}</button>
        </div>
      `;

      let html = "";

      if (pageIndex === 0){
        html = `
          <div class="paper ${flipClass}">
            <div class="tag">üíå Carta</div>
            <h2 class="title" style="margin-top:10px;">Tengo una sorpresa para vos üíñ</h2>
            <p class="subtitle">
              Esta vez no quise regalar algo: quise <b>regalarnos un plan</b>.
              <br/>Algo que ya sabemos que nos hace bien.
              <br/>And√° pasando p√°gina‚Ä¶ lo dem√°s se revela solo üíò
            </p>

            <div class="divider"></div>

            <div class="valentineNote">
              Solo segu√≠ p√°gina por p√°gina.
            </div>

            ${commonNav("‚Äî", "Abrir la primera p√°gina", false, true)}
          </div>
        `;
      }

      if (pageIndex === 1){
        html = `
          <div class="paper ${flipClass}">
            <div class="tag">üõ∂ Paso 1 ‚Ä¢ Aventura + Relax</div>
            <h2 class="title" style="margin-top:10px;">Adrenalina + Relax</h2>
            <p class="subtitle">
              Lo primero... <b>rafting</b> por el canal y despu√©s relajaci√≥n en <b>Hotel Spa Cacheuta</b>.
            </p>

            <div class="twoCols">
              <div>
                <div class="tag">üõ∂ Rafting</div>
                <div class="frame" style="margin-top:10px;">
                  <img class="img" id="raftingCarousel" src="${RAFTING_IMAGES[0]}" alt="Rafting">
                </div>
                <p class="subtitle" style="margin-top:10px;">Para ir entrando en el mood üòå</p>
              </div>

              <div>
                <div class="tag">üíÜ Relax ‚Äî Spa Cacheuta</div>
                <div class="frame" style="margin-top:10px;">
                  <img class="img" id="relaxCarousel" src="${RELAX_IMAGES[0]}" alt="Relax Cacheuta">
                </div>
                <p class="subtitle" style="margin-top:10px;">
                  Vibes: termas, calma y desconexi√≥n üíó
                </p>
              </div>
            </div>

            ${commonNav("Volver a la carta", "Destrabar alojamiento", true, true)}
          </div>
        `;
      }

      if (pageIndex === 2){
        html = `
          <div class="paper ${flipClass}">
            <div class="tag">üè° Paso 2 ‚Ä¢ Alojamiento</div>
            <h2 class="title" style="margin-top:10px;">Nuestro refugio en Mendoza üíñ</h2>
            <p class="subtitle">
              Hotel: <b>Puerta del Sol</b>
              <br/>Entrada: <b>jue, 12 mar 2026</b> (desde 12:00) ‚Ä¢ Salida: <b>dom, 15 mar 2026</b> (10:00 a 10:30)
            </p>

            <div class="twoCols">
              <div>
                <div class="tag">üì∏ Foto del hotel</div>
                <div class="frame" style="margin-top:10px;">
                  <img class="img" src="${HOTEL_IMAGE}" alt="Hotel Puerta del Sol">
                </div>
                <p class="subtitle" style="margin-top:10px;">Un lugar lindo para estar tranquilos üòå</p>
              </div>

              <div>
                <div class="tag">üó∫Ô∏è Mapa</div>
                <div class="map" style="margin-top:10px;">
                  <iframe
                    src="https://www.google.com/maps?q=Garibaldi%2082,%205500%20Mendoza,%20Argentina&output=embed"
                    loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade"
                    title="Mapa Hotel Puerta del Sol"></iframe>
                </div>
                <div style="margin-top:10px;">
                  <a class="link" target="_blank" rel="noopener"
                    href="https://www.google.com/maps/search/?api=1&query=Garibaldi%2082%2C%205500%20Mendoza%2C%20Argentina">üìç Abrir en Google Maps</a>
                </div>
              </div>
            </div>

            ${commonNav("Volver al Paso 1", "Destrabar vuelo", true, true)}
          </div>
        `;
      }

      if (pageIndex === 3){
        html = `
          <div class="paper ${flipClass}">
            <div class="tag">‚úàÔ∏è Paso 3 ‚Ä¢ Vuelo</div>
            <h2 class="title" style="margin-top:10px;">Ahora s√≠: el viaje üíò</h2>

            <div class="pass">
              <div class="passTop">
                <strong>S√çNTESIS DEL VUELO</strong>
                <span class="tag" style="background:rgba(255,255,255,.65)">Flybondi</span>
              </div>

              <div class="passGrid">
                <div class="kv"><span>Ida</span><b>Buenos Aires (AEP) ‚Üí Mendoza (MDZ)</b></div>
                <div class="kv"><span>Salida</span><b>jue 12 mar 2026 ‚Ä¢ 19:45</b></div>
                <div class="kv"><span>Llegada</span><b>jue 12 mar 2026 ‚Ä¢ 21:40</b></div>

                <div class="kv"><span>Vuelta</span><b>Mendoza (MDZ) ‚Üí Buenos Aires (AEP)</b></div>
                <div class="kv"><span>Salida</span><b>dom 15 mar 2026 ‚Ä¢ 20:15</b></div>
                <div class="kv"><span>Llegada</span><b>dom 15 mar 2026 ‚Ä¢ 21:55</b></div>

                <div class="kv"><span>Equipaje incluido</span><b>1 objeto personal ‚Ä¢ 6 kg</b></div>
                <div class="kv"><span>Medidas</span><b>20 √ó 40 √ó 30 cm</b></div>
                <div class="kv"><span>Extra</span><b>Carry-on / bodega: no incluido</b></div>
              </div>

              <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px;">
                <a class="link" href="./BA - MZ MER.pdf" download>‚¨áÔ∏è PDF (Ida)</a>
                <a class="link" href="./MZ - BA MER.pdf" download>‚¨áÔ∏è PDF (Vuelta)</a>
              </div>

              <div class="valentineNote" style="margin-top:12px;">
                üéÅ Mensaje final:
                <br/><b>Arm√° la mochila que el resto lo resuelvo yoüòå</b>
              </div>
            </div>

            ${commonNav("Volver al Paso 2", "Fin üíó", true, false)}
          </div>
        `;
      }

      els.page.innerHTML = html;

      const btnPrev = document.getElementById("btnPrev");
      const btnNext = document.getElementById("btnNext");
      if (btnPrev) btnPrev.addEventListener("click", prev);
      if (btnNext) btnNext.addEventListener("click", next);

      if (pageIndex === 1){
        startCarousel("raftingCarousel", RAFTING_IMAGES);
        startCarousel("relaxCarousel", RELAX_IMAGES);
      }
    }

    // Swipe navigation
    let touchStartX = 0;
    let touchStartY = 0;
    let touching = false;

    function onTouchStart(e){
      if (!e.touches || !e.touches[0]) return;
      touching = true;
      touchStartX = e.touches[0].clientX;
      touchStartY = e.touches[0].clientY;
    }
    function onTouchEnd(e){
      if (!touching) return;
      touching = false;
      const t = (e.changedTouches && e.changedTouches[0]) ? e.changedTouches[0] : null;
      if (!t) return;
      const dx = t.clientX - touchStartX;
      const dy = t.clientY - touchStartY;

      if (Math.abs(dx) < 50 || Math.abs(dx) < Math.abs(dy)) return;

      if (dx < 0) next(); else prev();
    }

    // Desktop pointer drag
    let pointerDown = false;
    let pStartX = 0, pStartY = 0;
    function onPointerDown(e){
      pointerDown = true;
      pStartX = e.clientX;
      pStartY = e.clientY;
    }
    function onPointerUp(e){
      if (!pointerDown) return;
      pointerDown = false;
      const dx = e.clientX - pStartX;
      const dy = e.clientY - pStartY;
      if (Math.abs(dx) < 70 || Math.abs(dx) < Math.abs(dy)) return;
      if (dx < 0) next(); else prev();
    }

    els.btnStart.addEventListener("click", ()=>{
      unlockUpTo(1);
      goTo(1);
    });

    els.btnReset.addEventListener("click", ()=>{
      if (PERSIST_PROGRESS){
        localStorage.removeItem("sv_page");
        localStorage.removeItem("sv_unlocked");
      }
      currentPage = 0;
      unlockedPage = 0;
      goTo(0, {animate:false});
    });

    els.book.addEventListener("touchstart", onTouchStart, {passive:true});
    els.book.addEventListener("touchend", onTouchEnd, {passive:true});
    els.book.addEventListener("pointerdown", onPointerDown);
    window.addEventListener("pointerup", onPointerUp);

    // On load, keep unlocked >= current
    unlockedPage = Math.max(unlockedPage, currentPage);
    setState("sv_unlocked", unlockedPage);

    goTo(currentPage, {animate:false});
  </script>
</body>
</html>
